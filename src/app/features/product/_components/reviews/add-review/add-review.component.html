<div class="add-review-wrapper" *ngIf="product as p">
  <!-- Left: Guidelines -->
  <aside class="guidelines">
    <h3>What makes a good review</h3>
    <ul>
      <li><strong>Have you used this product?</strong> Share your experience.</li>
      <li><strong>Why review a product?</strong> Help fellow shoppers.</li>
      <li><strong>How to review?</strong> Be honest, helpful, and factual.</li>
    </ul>
  </aside>

  <!-- Right: Review Form -->
  <section class="form-section">
    <div class="product-meta">
      <span class="product-name">{{ p.name }}</span>
      <img [src]="getImagePath(p.image)" alt="{{ p.name }}" loading="lazy" (error)="onImageError($event)" />
    </div>

    <!-- star rating should support [(ngModel)] OR ControlValueAccessor; if it’s CVA, bind via formControlName -->
    <app-star-rating [rating]="form.get('rating')!.value"
      (ratingChange)="form.get('rating')!.setValue($event)"></app-star-rating>

    <textarea class="form-control" placeholder="Write your experience (min 10 chars)…" rows="5"
      [formControl]="ctrl('description')"></textarea>

    <input class="form-control mt-2" placeholder="Title (optional)" [formControl]="ctrl('title')" />

    <button class="submit-btn mt-3" (click)="submitReview()" [disabled]="loading || form.invalid">
      {{ loading ? 'Submitting…' : 'Submit Review' }}
    </button>

    <p class="text-danger mt-2" *ngIf="error">{{ error }}</p>
  </section>
</div>
