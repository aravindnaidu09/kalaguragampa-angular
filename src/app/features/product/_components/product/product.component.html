<div class="product-card">
  <!-- ‚ù§Ô∏è Wishlist Icon -->
  <div class="wishlist-icon" (click)="onWishlistClick()">
    <ng-container *ngIf="!isUpdatingWishlist; else wishlistLoader">
      <span *ngIf="isWishlistedSignal(); else notWishlisted">‚ù§Ô∏è</span>
      <ng-template #notWishlisted><span>ü§ç</span></ng-template>
    </ng-container>
    <ng-template #wishlistLoader>
      <div class="spinner mini"></div>
    </ng-template>
  </div>

  <!-- üì¶ Product Image -->
  <div class="product-image" (click)="navigateViewProduct(product.name!, product.id!)">
    <img [src]="getImagePath(product.images?.[0]?.image)" alt="{{ product.name }}" loading="lazy"
      (error)="onImageError($event)" />
  </div>

  <!-- üìù Product Details -->
  <div class="product-details">
    <div class="product-header" (click)="navigateViewProduct(product.name!, product.id!)">
      <h4 [title]="product.name">{{ product.name }}</h4>
    </div>

    <div class="product-price">
      {{ currencyService.format(product?.price, currencyService.currency()) }}
    </div>

    <div class="rating-cart-wrapper">
      <div class="product-rating">
        ({{ product.rating }}) ‚≠ê | ({{product.reviewsCount}})
      </div>

      <!-- üõí Add to Cart (loader controlled by parent) -->
      <div class="add-to-cart-wrapper" [class.loading]="isUpdatingCart" (click)="addToCart(product)">
        <ng-container *ngIf="!isUpdatingCart; else cartLoader">
          <span class="add-to-cart-icon" role="button" tabindex="0" aria-label="Add to Cart"
            [attr.aria-busy]="isUpdatingCart">üõí</span>
        </ng-container>
        <ng-template #cartLoader>
          <div class="spinner mini"></div>
        </ng-template>
        <div class="tooltip">Add to Cart</div>
      </div>
    </div>
  </div>

</div>
