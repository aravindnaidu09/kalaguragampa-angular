<app-breadcrumb></app-breadcrumb>

<div class="wishlist-container">
  <!-- ‚úÖ Wishlist Header -->
  <div class="wishlist-header">
    <h2>Your Wishlist</h2>
    <button *ngIf="wishlistItems().length > 0" class="clear-wishlist-btn" (click)="clearWishlist()">üóëÔ∏è Clear
      All</button>
  </div>


  <ng-container *ngIf="!(wishlistItems().length > 0)">
    <div (click)="goToHomePage()" class="d-flex justify-content-center">
      <img style="cursor: pointer;" src="../../../../../assets/images/empty-wishlist.webp" width="auto"
        height="400px" />
    </div>
  </ng-container>

  <ng-container *ngIf="wishlistItems().length > 0">
    <!-- ‚úÖ Skeleton Loader -->
    <div *ngIf="isLoading()" class="wishlist-skeleton-container">
      <div *ngFor="let _ of [1,2,3,4,5]" class="wishlist-skeleton-card">
        <div class="skeleton-image"></div>
        <div class="skeleton-text"></div>
        <div class="skeleton-text small"></div>
        <div class="skeleton-footer">
          <div class="skeleton-btn"></div>
          <div class="skeleton-btn"></div>
        </div>
      </div>
    </div>

    <!-- ‚úÖ Wishlist Product Grid/List -->
    <div class="wishlist-items" [ngClass]="{ grid: gridView(), list: !gridView() }">
      <div *ngFor="let product of wishlistItems(); trackBy: trackById" class="wishlist-card">

        <!-- ‚úÖ Card Header (Image) -->
        <div class="wishlist-card-header" (click)="goToProduct(product)">
          <img [src]="getImagePath(product.productDetails?.images?.[0]?.image)" alt="{{ product.productDetails.name }}"
            loading="lazy" (error)="onImageError($event)" [title]="product.productDetails.name" />
        </div>

        <!-- ‚úÖ Card Body (Details) -->
        <div class="wishlist-card-body">
          <h3 [title]="product.productDetails.name" (click)="goToProduct(product)">
            {{ product.productDetails.name | slice:0:30 }}<span
              *ngIf="product.productDetails?.name!.length > 30">...</span>
          </h3>
          <p class="wishlist-price">
            {{ currencyService.format(product.productDetails.price, currencyService.currency()) }}
          </p>
        </div>

        <!-- ‚úÖ Actions -->
        <div class="wishlist-card-footer">
          <!-- Delete -->
          <button class="icon-btn wishlist-remove" title="Remove" (click)="onRemoveClick(product.id)"
            [class.animating]="animatingDeleteId === product.id">
            <ng-container *ngIf="removingItemIds.has(product.id!); else removeIcon">
              <div class="spinner mini"></div>
            </ng-container>
            <ng-template #removeIcon>
              <span class="trash">
                <mat-icon class="trash-can" fontIcon="delete"></mat-icon>
                <span class="trash-lid"></span>
              </span>
            </ng-template>
          </button>

          <!-- Move to Cart -->
          <button class="icon-btn wishlist-cart" title="Move to Cart" (click)="addToCart(product)">
            <ng-container *ngIf="movingItemIds.has(product.id!); else cartIcon">
              <div class="spinner mini"></div>
            </ng-container>
            <ng-template #cartIcon>
              <span class="emoji-icon" aria-hidden="true">üõí</span>
            </ng-template>
          </button>

        </div>


      </div>
    </div>

    <!-- Overlay Loader for bulk actions -->
    <div class="overlay-loader" *ngIf="isBulkClearing || isBulkAdding">
      <div class="spinner"></div>
    </div>

    <!-- ‚úÖ Add All to Cart Button -->
    <button class="add-all-button" (click)="addAllToCart()">üõí Add All Items to Cart</button>

  </ng-container>


</div>
