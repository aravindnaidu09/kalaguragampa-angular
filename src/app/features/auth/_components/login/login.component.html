<div class="login-with-otp">
  <!-- Left Image Section -->
  <div class="left-section">
    <img src="../../../../../assets/images/sign-in-page.png" alt="Kalagura Gampa" />
  </div>

  <!-- Right Content Section -->
  <ng-container *ngIf="!isRegistering(); else signUpForm">
    <div class="right-section">
      <h2 class="title">Let's Sign You In</h2>
      <p class="subtitle">Welcome</p>

      <!-- Login with OTP Form -->
      <form *ngIf="activeLoginMethod === 'otp'" [formGroup]="loginOtpForm" (ngSubmit)="onSubmitOtp()">
        <div class="form-group">
          <label for="mobileNumber">Mobile Number</label>
          <input type="text" id="mobileNumber" class="form-control" placeholder="Enter your mobile number"
            formControlName="mobileNumber" (input)="onMobileNumberInput()" />
          <small *ngIf="loginOtpForm.get('mobileNumber')?.invalid && loginOtpForm.get('mobileNumber')?.touched"
            class="validation-message">Enter a valid 10-digit mobile number.</small>

          <p class="info-text">
            <ng-container *ngIf="(isOtpRequested$ | async); else sendOtpTemplate">
              <ng-container *ngIf="(isResendAvailable$ | async); else timerTemplate">
                <a class="resend-otp-link" (click)="resendOtp($event)" [class.disabled]="isLoading">
                  <span *ngIf="!isLoading">Resend OTP</span>
                  <span *ngIf="isLoading" class="loader"></span>
                </a>
              </ng-container>
              <ng-template #timerTemplate>
                <span class="otp-timer">Resend in {{ otpCooldown$ | async }}s</span>
              </ng-template>
            </ng-container>

            <ng-template #sendOtpTemplate>
              <a class="send-otp-link" (click)="sendOtp($event)" [class.disabled]="isLoading">
                <span *ngIf="!isLoading">Send OTP</span>
                <span *ngIf="isLoading" class="loader"></span>
              </a>
            </ng-template>
          </p>
        </div>

        <div class="form-group" *ngIf="isOtpSent">
          <label for="otp">OTP</label>
          <input type="text" id="otp" class="form-control" placeholder="Enter OTP" formControlName="otp"
            maxlength="5" />
          <small *ngIf="loginOtpForm.get('otp')?.invalid && loginOtpForm.get('otp')?.touched" class="validation-message">OTP
            must be 5 characters long.</small>
        </div>

        <button type="submit" class="btn-signin" [disabled]="isLoginBlocked || loginOtpForm.invalid">
          <span *ngIf="!isSignInLoading">Sign In</span>
          <span *ngIf="isSignInLoading" class="signIn-loader"></span>
        </button>
        <p *ngIf="isLoginBlocked" class="validation-message">Too many attempts. Try again in {{ loginCooldown }}s.</p>

        <!-- Register Link -->
        <p class="register-text">
          Don't have an account? <a (click)="onRegister()" class="register-link">Register</a>
        </p>
      </form>
    </div>
  </ng-container>

  <ng-template #signUpForm>
    <div class="right-section">
      <app-sign-up></app-sign-up>
    </div>
  </ng-template>
</div>
